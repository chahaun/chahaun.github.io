---
layout: post
title:  "HTML API"
subtitle:   "Application Programming Interface"
categories: study
tags: web html API
---

HTML API에 대해서 알아본다.

# HTML API

### 드래그 앤 드롭(Drag and Drop)

특정 요소를 드래그하여 다른 영역에 놓으면 요소의 위치가 새롭게 변경되는 API이다.  
draggable 속성을 사용하며, `<img draggable="true" src="~.jpg" ondragstart="함수명(event)" id="img1">` 처럼 작성한다.  
script태그의 함수 내에서는 어디에 드롭 될지를 구현한다.  
~~~
<style>
  div {
    width: 150px; height:150px; border: 1px solid black;
  }
</style>
<script>
function f1(e) {
  e.dataTransfer.setData("text", e.target.id);
}
function f2(e) {
  e.preventDefault(); // 이벤트의 기본 처리를 막는다.
}
function f3(e) {
  e.preventDefault();
  var x = e.dataTransfer.getData("text");
  e.target.appendChild(document.getElementById(x));
}
</script>
<div id="dragDiv" ondragover="f2(event)" ondrop="f3(event)">div의 내용</div>
<img draggable="true" src="~.jpg" ondragstart="f1(event)" id="img1">
~~~
위 소스는 div의 영역에 이미지를 드롭하기 전 f2함수가 호출하여 요소의 기본처리를 막는다.  
이후 드롭이벤트가 발생하여 f3함수가 호출되며 데이터를 읽은 후 img를 자식으로 추가한다.  
이미지를 네모난 칸에 가져와서 자식으로 추가하는 코드이다.  

### 위치 서비스

사용자의 현재 위치를 알려주거나 현재 위치를 지도에 표현하는 기능을 제공하는 것으로, 사용자 컴퓨터에 위치접근 설정이
허가되지 않았다면 사용할 수 없다. 그러므로 위치 서비스 기능을 테스트하기 전에 사용중인 컴퓨터에서 위치접근 허용을 설정한다.  

위치 서비스 API를 사용하려면 navigator.geolocation객체를 인식해야 한다.  
이 객체의 getCurrentPosition()은 사용자의 현재 위치를 얻는다.  
이 메서드가 반환하는 위치정보는 위도,경도,정확도,고도,고도정확도가 있다.  
~~~
function f1() {
  if(navigator.geolocation) {
    navigator.geolocation.getCurrentPosition(f2); // 위치 값을 전달
  } else {
    var result = document.getElementById("result");
    result.innerHTML = "위치 서비스가 지원되지 않습니다.";
  }
}
function f2(position) {
  var result = document.getElementById("result");
  result.innetHTML = "위도: " + position.coords.latitude;
}
<button onclick="f1()">위치확인하기</button>
<div id="result"></div>
~~~
위 코드는 버튼을 누르면 위도를 받아 출력하는 소스이다.  

구글 맵 서비스를 요청하여 지도를 출력할 수도 있다. 위 코드에서 수정/추가한다.  
~~~
function f2(position) {
  var latlon = position.coords.latitude+","+position.coords.longitude;
  var img_url = "http://maps.googleapis.com/maps/api/staticmap?center="+latlon+"&zoom=14&size=400x300&sensor=false";
  document.getElementById("map").innerHTML="<img src=""+img_url+"">";
}
...
<div id = "map"></div>
~~~

에러 처리는 getCurrentPosition의 두번째 파라미터를 이용한다.  
`navigator.geolocation.getCurrentPosition(f2, printError);`  
이 코드 이후 printError함수를 생성하여 에러종류 별 처리코드를 작성한다.  

### 데이터 로컬 저장

